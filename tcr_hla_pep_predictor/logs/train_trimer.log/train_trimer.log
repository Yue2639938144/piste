2025-06-22 19:35:36 - train_trimer - INFO - 从configs/default_config.yaml加载配置...
2025-06-22 19:35:36 - train_trimer - INFO - 使用设备: cpu
2025-06-22 19:35:36 - train_trimer - INFO - 加载训练数据...
2025-06-22 19:35:36 - train_trimer - INFO - 训练数据大小: (4, 5)
2025-06-22 19:35:36 - train_trimer - INFO - 加载验证数据...
2025-06-22 19:35:36 - train_trimer - INFO - 验证数据大小: (2, 5)
2025-06-22 19:35:36 - train_trimer - INFO - 加载测试数据...
2025-06-22 19:35:36 - train_trimer - INFO - 测试数据大小: (2, 5)
2025-06-22 19:35:36 - train_trimer - INFO - 创建数据集...
2025-06-22 19:35:36 - train_trimer - INFO - 创建数据加载器...
2025-06-22 19:35:36 - train_trimer - INFO - 加载预训练的二元模型...
2025-06-22 19:43:51 - train_trimer - INFO - 从configs/default_config.yaml加载配置...
2025-06-22 19:43:51 - train_trimer - INFO - 使用设备: cpu
2025-06-22 19:43:51 - train_trimer - INFO - 加载训练数据...
2025-06-22 19:43:51 - train_trimer - INFO - 训练数据大小: (4, 5)
2025-06-22 19:43:51 - train_trimer - INFO - 加载验证数据...
2025-06-22 19:43:51 - train_trimer - INFO - 验证数据大小: (2, 5)
2025-06-22 19:43:51 - train_trimer - INFO - 加载测试数据...
2025-06-22 19:43:51 - train_trimer - INFO - 测试数据大小: (2, 5)
2025-06-22 19:43:51 - train_trimer - INFO - 创建数据集...
2025-06-22 19:43:51 - train_trimer - INFO - 创建数据加载器...
2025-06-22 19:43:51 - train_trimer - INFO - 加载预训练的二元模型...
2025-06-22 19:45:09 - train_trimer - INFO - 从configs/default_config.yaml加载配置...
2025-06-22 19:45:09 - train_trimer - INFO - 使用设备: cpu
2025-06-22 19:45:09 - train_trimer - INFO - 加载训练数据...
2025-06-22 19:45:09 - train_trimer - INFO - 训练数据大小: (4, 5)
2025-06-22 19:45:09 - train_trimer - INFO - 加载验证数据...
2025-06-22 19:45:09 - train_trimer - INFO - 验证数据大小: (2, 5)
2025-06-22 19:45:09 - train_trimer - INFO - 加载测试数据...
2025-06-22 19:45:09 - train_trimer - INFO - 测试数据大小: (2, 5)
2025-06-22 19:45:09 - train_trimer - INFO - 创建数据集...
2025-06-22 19:45:09 - train_trimer - INFO - 创建数据加载器...
2025-06-22 19:45:09 - train_trimer - INFO - 加载预训练的二元模型...
2025-06-22 19:45:09 - train_trimer - INFO - 创建三元模型...
2025-06-22 19:45:09 - train_trimer - INFO - 开始训练...
2025-06-22 19:45:09 - train_trimer - INFO - 开始训练阶段 1/2: 冻结二元模型训练
2025-06-22 19:45:09 - train_trimer - INFO - 冻结二元模型参数...
2025-06-22 19:45:19 - train_trimer - INFO - Phase 1 - Epoch 1/50 (Global 1) - Train Loss: 2.1096, Train F1: 0.0000, Val Loss: 2.2108, Val F1: 0.0000, Threshold: 0.4630
2025-06-22 19:45:28 - train_trimer - INFO - Phase 1 - Epoch 2/50 (Global 2) - Train Loss: 2.0678, Train F1: 0.0000, Val Loss: 2.2279, Val F1: 0.0000, Threshold: 0.4874
2025-06-22 19:45:37 - train_trimer - INFO - Phase 1 - Epoch 3/50 (Global 3) - Train Loss: 2.0964, Train F1: 0.8000, Val Loss: 2.2529, Val F1: 0.0000, Threshold: 0.4764
2025-06-22 19:45:46 - train_trimer - INFO - Phase 1 - Epoch 4/50 (Global 4) - Train Loss: 2.0651, Train F1: 0.8000, Val Loss: 2.2778, Val F1: 0.0000, Threshold: 0.4434
2025-06-22 19:45:56 - train_trimer - INFO - Phase 1 - Epoch 5/50 (Global 5) - Train Loss: 1.9683, Train F1: 0.6667, Val Loss: 2.3024, Val F1: 0.0000, Threshold: 0.4541
2025-06-22 19:46:05 - train_trimer - INFO - Phase 1 - Epoch 6/50 (Global 6) - Train Loss: 2.0924, Train F1: 0.5000, Val Loss: 2.3334, Val F1: 0.0000, Threshold: 0.4189
2025-06-22 19:46:14 - train_trimer - INFO - Phase 1 - Epoch 7/50 (Global 7) - Train Loss: 2.0551, Train F1: 0.6667, Val Loss: 2.3707, Val F1: 0.0000, Threshold: 0.3758
2025-06-22 19:46:24 - train_trimer - INFO - Phase 1 - Epoch 8/50 (Global 8) - Train Loss: 1.9338, Train F1: 1.0000, Val Loss: 2.4059, Val F1: 0.0000, Threshold: 0.3544
2025-06-22 19:46:33 - train_trimer - INFO - Phase 1 - Epoch 9/50 (Global 9) - Train Loss: 2.0317, Train F1: 0.6667, Val Loss: 2.4298, Val F1: 0.0000, Threshold: 0.3813
2025-06-22 19:46:43 - train_trimer - INFO - Phase 1 - Epoch 10/50 (Global 10) - Train Loss: 1.8939, Train F1: 0.6667, Val Loss: 2.4684, Val F1: 0.0000, Threshold: 0.3976
2025-06-22 19:46:53 - train_trimer - INFO - Phase 1 - Epoch 11/50 (Global 11) - Train Loss: 2.0004, Train F1: 0.8000, Val Loss: 2.5139, Val F1: 0.0000, Threshold: 0.3985
2025-06-22 19:47:03 - train_trimer - INFO - Phase 1 - Epoch 12/50 (Global 12) - Train Loss: 1.9502, Train F1: 0.8000, Val Loss: 2.5709, Val F1: 0.0000, Threshold: 0.3675
2025-06-22 19:47:13 - train_trimer - INFO - Phase 1 - Epoch 13/50 (Global 13) - Train Loss: 2.0035, Train F1: 1.0000, Val Loss: 2.6033, Val F1: 0.0000, Threshold: 0.3460
2025-06-22 19:47:23 - train_trimer - INFO - Phase 1 - Epoch 14/50 (Global 14) - Train Loss: 1.9641, Train F1: 1.0000, Val Loss: 2.6434, Val F1: 0.0000, Threshold: 0.2976
2025-06-22 19:47:33 - train_trimer - INFO - Phase 1 - Epoch 15/50 (Global 15) - Train Loss: 1.9516, Train F1: 1.0000, Val Loss: 2.6938, Val F1: 0.0000, Threshold: 0.2514
2025-06-22 19:47:43 - train_trimer - INFO - Phase 1 - Epoch 16/50 (Global 16) - Train Loss: 2.0572, Train F1: 0.6667, Val Loss: 2.7366, Val F1: 0.0000, Threshold: 0.2335
2025-06-22 19:47:53 - train_trimer - INFO - Phase 1 - Epoch 17/50 (Global 17) - Train Loss: 1.8974, Train F1: 0.6667, Val Loss: 2.7683, Val F1: 0.0000, Threshold: 0.2385
2025-06-22 19:48:03 - train_trimer - INFO - Phase 1 - Epoch 18/50 (Global 18) - Train Loss: 1.9246, Train F1: 0.6667, Val Loss: 2.7984, Val F1: 0.0000, Threshold: 0.2651
2025-06-22 19:48:13 - train_trimer - INFO - Phase 1 - Epoch 19/50 (Global 19) - Train Loss: 1.8877, Train F1: 1.0000, Val Loss: 2.8364, Val F1: 0.0000, Threshold: 0.2967
2025-06-22 19:48:22 - train_trimer - INFO - Phase 1 - Epoch 20/50 (Global 20) - Train Loss: 1.8310, Train F1: 0.8000, Val Loss: 2.8813, Val F1: 0.0000, Threshold: 0.3081
2025-06-22 19:48:32 - train_trimer - INFO - Phase 1 - Epoch 21/50 (Global 21) - Train Loss: 1.6860, Train F1: 1.0000, Val Loss: 2.9287, Val F1: 0.0000, Threshold: 0.2935
2025-06-22 19:48:32 - train_trimer - INFO - 早停触发，最佳轮次: 0
2025-06-22 19:48:32 - train_trimer - INFO - 开始训练阶段 2/2: 联合训练
2025-06-22 19:48:32 - train_trimer - INFO - 解冻二元模型参数...
2025-06-22 20:06:59 - train_trimer - INFO - 从configs/default_config.yaml加载配置...
2025-06-22 20:06:59 - train_trimer - INFO - 使用设备: cpu
2025-06-22 20:06:59 - train_trimer - INFO - 加载训练数据...
2025-06-22 20:06:59 - train_trimer - INFO - 训练数据大小: (4, 5)
2025-06-22 20:06:59 - train_trimer - INFO - 加载验证数据...
2025-06-22 20:06:59 - train_trimer - INFO - 验证数据大小: (2, 5)
2025-06-22 20:06:59 - train_trimer - INFO - 加载测试数据...
2025-06-22 20:06:59 - train_trimer - INFO - 测试数据大小: (2, 5)
2025-06-22 20:06:59 - train_trimer - INFO - 创建数据集...
2025-06-22 20:06:59 - train_trimer - INFO - 创建数据加载器...
2025-06-22 20:06:59 - train_trimer - INFO - 加载预训练的二元模型...
2025-06-22 20:06:59 - train_trimer - INFO - 创建三元模型...
2025-06-22 20:06:59 - train_trimer - INFO - 开始训练...
2025-06-22 20:06:59 - train_trimer - INFO - 开始训练阶段 1/2: 冻结二元模型训练
2025-06-22 20:06:59 - train_trimer - INFO - 冻结二元模型参数...
2025-06-22 20:07:10 - train_trimer - INFO - Phase 1 - Epoch 1/50 (Global 1) - Train Loss: 2.1232, Train F1: 0.0000, Val Loss: 2.2406, Val F1: 0.0000, Threshold: 0.4760
2025-06-22 20:07:20 - train_trimer - INFO - Phase 1 - Epoch 2/50 (Global 2) - Train Loss: 2.0926, Train F1: 0.8000, Val Loss: 2.2741, Val F1: 0.0000, Threshold: 0.4510
2025-06-22 20:07:30 - train_trimer - INFO - Phase 1 - Epoch 3/50 (Global 3) - Train Loss: 2.1113, Train F1: 0.6667, Val Loss: 2.3042, Val F1: 0.0000, Threshold: 0.4593
2025-06-22 20:07:40 - train_trimer - INFO - Phase 1 - Epoch 4/50 (Global 4) - Train Loss: 2.1243, Train F1: 0.8000, Val Loss: 2.3359, Val F1: 0.0000, Threshold: 0.4477
2025-06-22 20:07:50 - train_trimer - INFO - Phase 1 - Epoch 5/50 (Global 5) - Train Loss: 1.9877, Train F1: 1.0000, Val Loss: 2.3713, Val F1: 0.0000, Threshold: 0.4373
2025-06-22 20:08:01 - train_trimer - INFO - Phase 1 - Epoch 6/50 (Global 6) - Train Loss: 2.0704, Train F1: 0.5000, Val Loss: 2.4125, Val F1: 0.0000, Threshold: 0.3822
2025-06-22 20:08:11 - train_trimer - INFO - Phase 1 - Epoch 7/50 (Global 7) - Train Loss: 2.0181, Train F1: 0.6667, Val Loss: 2.4587, Val F1: 0.0000, Threshold: 0.3371
2025-06-22 20:08:21 - train_trimer - INFO - Phase 1 - Epoch 8/50 (Global 8) - Train Loss: 1.9483, Train F1: 1.0000, Val Loss: 2.4973, Val F1: 0.0000, Threshold: 0.3369
2025-06-22 20:08:31 - train_trimer - INFO - Phase 1 - Epoch 9/50 (Global 9) - Train Loss: 1.9932, Train F1: 1.0000, Val Loss: 2.5382, Val F1: 0.0000, Threshold: 0.3641
2025-06-22 20:08:41 - train_trimer - INFO - Phase 1 - Epoch 10/50 (Global 10) - Train Loss: 1.9029, Train F1: 0.6667, Val Loss: 2.5913, Val F1: 0.0000, Threshold: 0.3756
2025-06-22 20:08:51 - train_trimer - INFO - Phase 1 - Epoch 11/50 (Global 11) - Train Loss: 1.9869, Train F1: 0.8000, Val Loss: 2.6588, Val F1: 0.0000, Threshold: 0.3281
2025-06-22 20:09:01 - train_trimer - INFO - Phase 1 - Epoch 12/50 (Global 12) - Train Loss: 1.9498, Train F1: 0.6667, Val Loss: 2.7325, Val F1: 0.0000, Threshold: 0.2875
2025-06-22 20:09:11 - train_trimer - INFO - Phase 1 - Epoch 13/50 (Global 13) - Train Loss: 2.0523, Train F1: 0.5000, Val Loss: 2.7789, Val F1: 0.0000, Threshold: 0.2673
2025-06-22 20:09:22 - train_trimer - INFO - Phase 1 - Epoch 14/50 (Global 14) - Train Loss: 1.9772, Train F1: 0.8000, Val Loss: 2.8362, Val F1: 0.0000, Threshold: 0.2280
2025-06-22 20:09:31 - train_trimer - INFO - Phase 1 - Epoch 15/50 (Global 15) - Train Loss: 1.9388, Train F1: 1.0000, Val Loss: 2.8943, Val F1: 0.0000, Threshold: 0.2060
2025-06-22 20:09:42 - train_trimer - INFO - Phase 1 - Epoch 16/50 (Global 16) - Train Loss: 1.9670, Train F1: 0.6667, Val Loss: 2.9508, Val F1: 0.0000, Threshold: 0.2027
2025-06-22 20:09:52 - train_trimer - INFO - Phase 1 - Epoch 17/50 (Global 17) - Train Loss: 1.8657, Train F1: 0.8000, Val Loss: 3.0086, Val F1: 0.0000, Threshold: 0.1968
2025-06-22 20:10:02 - train_trimer - INFO - Phase 1 - Epoch 18/50 (Global 18) - Train Loss: 1.8977, Train F1: 0.6667, Val Loss: 3.0661, Val F1: 0.0000, Threshold: 0.1950
2025-06-22 20:10:12 - train_trimer - INFO - Phase 1 - Epoch 19/50 (Global 19) - Train Loss: 1.8354, Train F1: 1.0000, Val Loss: 3.1286, Val F1: 0.0000, Threshold: 0.1930
2025-06-22 20:10:22 - train_trimer - INFO - Phase 1 - Epoch 20/50 (Global 20) - Train Loss: 1.8093, Train F1: 0.8000, Val Loss: 3.1965, Val F1: 0.0000, Threshold: 0.1705
2025-06-22 20:10:32 - train_trimer - INFO - Phase 1 - Epoch 21/50 (Global 21) - Train Loss: 1.6732, Train F1: 1.0000, Val Loss: 3.2679, Val F1: 0.0000, Threshold: 0.1509
2025-06-22 20:10:32 - train_trimer - INFO - 早停触发，最佳轮次: 0
2025-06-22 20:10:32 - train_trimer - INFO - 开始训练阶段 2/2: 联合训练
2025-06-22 20:10:32 - train_trimer - INFO - 解冻二元模型参数...
2025-06-22 20:10:43 - train_trimer - INFO - Phase 2 - Epoch 1/50 (Global 21) - Train Loss: 1.7832, Train F1: 1.0000, Val Loss: 4.9328, Val F1: 0.0000, Threshold: 0.0016
2025-06-22 20:10:43 - train_trimer - INFO - 早停触发，最佳轮次: 0
2025-06-22 20:10:43 - train_trimer - INFO - 加载最佳模型...
2025-06-22 20:10:43 - train_trimer - INFO - 在测试集上评估，使用阈值: 0.5000...
2025-06-22 20:10:48 - train_trimer - INFO - 保存最终模型到models\trimer_final.pt...
2025-06-22 20:10:48 - train_trimer - INFO - 训练完成!
