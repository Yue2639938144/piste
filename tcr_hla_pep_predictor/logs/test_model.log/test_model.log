2025-06-03 01:04:07 - test_model - INFO - 从configs/default_config.yaml加载配置...
2025-06-03 01:04:07 - test_model - INFO - 使用CPU
2025-06-03 01:04:07 - test_model - INFO - === 测试二元模型功能 ===
2025-06-03 01:04:07 - test_model - INFO - 创建TCR-Pep模型...
2025-06-03 01:06:39 - test_model - INFO - 从configs/default_config.yaml加载配置...
2025-06-03 01:06:39 - test_model - INFO - 使用CPU
2025-06-03 01:06:39 - test_model - INFO - === 测试二元模型功能 ===
2025-06-03 01:06:39 - test_model - INFO - 创建TCR-Pep模型...
2025-06-03 01:09:16 - test_model - INFO - 从configs/default_config.yaml加载配置...
2025-06-03 01:09:16 - test_model - INFO - 使用CPU
2025-06-03 01:09:16 - test_model - INFO - === 测试二元模型功能 ===
2025-06-03 01:09:16 - test_model - INFO - 创建TCR-Pep模型...
2025-06-03 01:09:16 - test_model - INFO - 创建HLA-Pep模型...
2025-06-03 01:09:16 - test_model - INFO - 创建测试数据...
2025-06-03 01:09:16 - test_model - INFO - 测试TCR-Pep模型前向传播...
2025-06-03 01:09:16 - test_model - INFO - TCR-Pep模型前向传播耗时: 0.0197秒
2025-06-03 01:09:16 - test_model - INFO - TCR-Pep预测结果形状: torch.Size([2])
2025-06-03 01:09:16 - test_model - INFO - TCR-Pep注意力权重形状: torch.Size([2, 30, 15])
2025-06-03 01:09:16 - test_model - INFO - 测试HLA-Pep模型前向传播...
2025-06-03 01:09:16 - test_model - INFO - HLA-Pep模型前向传播耗时: 0.0146秒
2025-06-03 01:09:16 - test_model - INFO - HLA-Pep预测结果形状: torch.Size([2])
2025-06-03 01:09:16 - test_model - INFO - HLA-Pep注意力权重形状: torch.Size([2, 34, 15])
2025-06-03 01:09:16 - test_model - INFO - 
=== 测试三元模型功能 ===
2025-06-03 01:09:16 - test_model - INFO - 创建三元模型...
2025-06-03 01:09:16 - test_model - INFO - 创建测试数据...
2025-06-03 01:09:16 - test_model - INFO - 测试三元模型前向传播...
2025-06-03 01:09:17 - test_model - INFO - 三元模型前向传播耗时: 0.0544秒
2025-06-03 01:09:17 - test_model - INFO - 三元模型预测结果形状: torch.Size([2])
2025-06-03 01:09:17 - test_model - INFO - 三元模型TCR-Pep预测结果形状: torch.Size([2])
2025-06-03 01:09:17 - test_model - INFO - 三元模型HLA-Pep预测结果形状: torch.Size([2])
2025-06-03 01:09:17 - test_model - INFO - 检查注意力权重...
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_pep_physical: 形状 torch.Size([2, 30, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_pep_data_driven: 形状 torch.Size([2, 30, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_pep_fused: 形状 torch.Size([2, 30, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 hla_pep_physical: 形状 torch.Size([2, 34, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 hla_pep_data_driven: 形状 torch.Size([2, 34, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 hla_pep_fused: 形状 torch.Size([2, 34, 15])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_hla_physical: 形状 torch.Size([2, 30, 34])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_hla_data_driven: 形状 torch.Size([2, 30, 34])
2025-06-03 01:09:17 - test_model - INFO - 注意力权重 tcr_hla_fused: 形状 torch.Size([2, 30, 34])
2025-06-03 01:09:17 - test_model - INFO - 
=== 测试真实数据加载和模型推理 ===
2025-06-03 01:09:17 - test_model - INFO - 加载测试数据: data/raw/test_data.csv
2025-06-03 01:09:17 - test_model - INFO - 测试数据大小: (2828, 8)
2025-06-03 01:09:17 - test_model - INFO - 创建数据集...
2025-06-03 01:09:17 - test_model - INFO - 创建数据加载器...
2025-06-03 01:09:17 - test_model - INFO - 创建模型...
2025-06-03 01:09:17 - test_model - INFO - 测试数据加载和模型推理...
2025-06-03 01:09:17 - test_model - INFO - 批次大小: 5
2025-06-03 01:09:17 - test_model - INFO - 预测结果: tensor([0.5796, 0.6054, 0.5706, 0.5740, 0.5441])
2025-06-03 01:09:17 - test_model - INFO - 真实数据测试完成
2025-06-03 01:09:17 - test_model - INFO - 测试完成
